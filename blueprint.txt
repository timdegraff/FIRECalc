================================================================================
TO DO LIST
================================================================================
[HUMAN-ONLY ACCESS: AI AGENTS ARE PROHIBITED FROM MODIFYING OR EDITING THIS BOX]
[THE FOLLOWING SECTION IS RESERVED FOR THE HUMAN ARCHITECT]

- [x] Implement "Cash Ceiling" optimization in Burndown to prevent over-selling high-basis stock.
- [x] Fix Brave/Safari login loops using signInWithRedirect and Auth-Pending states.
- [x] Sync "Nominal vs Real" toggles across Desktop and Mobile views.
- [x] Align Gross Amount and Growth % in Income Cards.
- [x] Replace non-taxable checkbox with "Non-Taxable Until (Year)" input.
- [ ] Add "Net Income" preview to Income cards (Gross - Taxes - 401k - Match).
- [ ] Implement "Educational Needs" section in Budget for 529 drawdown tracking.

================================================================================
PROJECT OVERVIEW: FIRECALC RETIREMENT PLANNER
================================================================================
FIRECalc is a high-fidelity financial architecture tool designed for precision 
planning, specifically optimized for the 2026 Michigan tax/benefit landscape. 
It focuses on MAGI (Modified Adjusted Gross Income) manipulation to maximize 
state benefits while simulating complex retirement bridges (72t/SEPP).

--------------------------------------------------------------------------------
CORE PHILOSOPHY & UI PREFERENCES
--------------------------------------------------------------------------------
1.  AESTHETICS: High-contrast "Dark Mode" (Slate-900/800). 
    - NUMBERS: Must use 'JetBrains Mono' or 'Inter' with tabular-nums.
    - LABELS: 'Inter' font with heavy tracking-tighter and 800+ weight.
2.  COLOR LOGIC (STRICT ADHERENCE):
    - Teal (#14b8a6): Growth, Assets, Net Worth, HSA.
    - Pink (#ec4899): Expenses, Liabilities, Debts.
    - Magenta/Pink-400 (#f472b6): Cash.
    - Emerald/Green-500 (#10b981): Brokerage / Taxable Assets.
    - Blue (#3b82f6): Pre-Tax / 401k / Strategy.
    - Purple (#a855f7): Post-Tax / Roth.
    - Amber/Orange (#f59e0b): Crypto (Bitcoin).
    - Yellow (#eab308): Metals (Gold).
    - Indigo (#6366f1): Real Estate.
    - Rose (#fb7185): 529 Plan.
    * NOTE: All Liabilities/Debt items must use Text-Red-400 or Text-Pink-400.
3.  AUTH & COMPATIBILITY: 
    - Uses Firebase Auth with Google Provider.
    - Brave/Safari fix: Must use `signInWithRedirect` instead of popups.
    - Application tracks `APP_VERSION` in localStorage to force clean reloads on updates.

--------------------------------------------------------------------------------
MOBILE ARCHITECTURE
--------------------------------------------------------------------------------
1.  DETECTION: Surgical redirect in index.html for widths < 768px.
2.  NAVIGATION: 6-tab fixed bottom bar (Assets, Income, Budget, More, Burndown, Chart).
3.  INPUTS: Global 16px font-size enforcement to prevent iOS auto-zoom.
4.  SWIPE ACTIONS: List items (Investments, Budget, etc.) use touch-start/move 
    listeners to reveal a red "Trash" action on left-swipe (-80px).
5.  SCROLLING: Natural document scrolling for Projection and Burndown tabs; 
    restricted internal scrolling only for large data tables.

--------------------------------------------------------------------------------
SPECIFIC USER PREFERENCES (DO NOT CHANGE)
--------------------------------------------------------------------------------
1.  PROJECTION TABLE:
    - Simulate to age 100.
    - First 10 years: Annual granularity.
    - Years 11-60: 5-year granularity (age % 5 === 0).
2.  BENEFITS LOGIC:
    - MAGI Slider increments: 1000.
    - Medicaid "Pregnant" limit: 195% FPL vs Standard 138% FPL.
    - Shelter costs in SNAP are always editable.
3.  TAX EFFICIENCY (EFF %):
    - Displayed on Investment rows.
    - Roth/529: Always 100%.
    - Pre-Tax: Calculated as 1 - (22% Fed + State Rate).
    - Taxable: Calculated based on Gain Ratio (Value - Basis) * Cap Gains Rate.

--------------------------------------------------------------------------------
BURNDOWN ENGINE & DECUMULATION LOGIC
--------------------------------------------------------------------------------
The engine is a sequential cash-flow simulator:

1.  BUDGET CALCULATION:
    - Sync Mode: (Sum of Budget Expenses) - (Items removed in retirement).
    - Manual Mode: User-defined flat amount.
    - Both apply inflation and "Go-Factor" adjustments based on age.

2.  WITHDRAWAL SEQUENCE (TWO-LOOP SYSTEM):
    - LOOP 1 (MAGI HARVESTING): Sells assets to reach the user's MAGI target 
      (e.g., to qualify for Silver CSR or Platinum Medicaid).
      - CRITICAL OPTIMIZATION: "Cash Ceiling". The engine stops harvesting MAGI 
        if the total cash raised (Drawn + Net Income) already covers the year's 
        Budget + estimated Taxes. This prevents over-selling high-basis stock.
    - LOOP 2 (CASH SHORTFALL): If Loop 1 didn't raise enough cash to pay the 
      bills, Loop 2 drains accounts in the user's "Draw Priority" order regardless 
      of MAGI impact until the budget is met.

3.  SOLVENCY TEST:
    - Net Worth includes (Liquid Assets + RE Equity - Debts).
    - Insolvency triggers when (Cash Available + SNAP < Budget + Taxes).

--------------------------------------------------------------------------------
PRE-POPULATED INITIAL DATA (CONSISTENCY REFERENCE)
--------------------------------------------------------------------------------
- Assumptions: Age 40, Retire 45, SS Start 62, SS $3k/mo. 
- Growth: Stock 10%, Crypto 10%, Metals 8%, RE 3.5%, Inflation 3%.
- Investments:
    - Emergency Fund (Cash): $25,000
    - Vanguard 401k (Pre-Tax): $300,000 (Basis: $200k)
    - Roth IRA (Post-Tax): $200,000 (Basis: $150k)
- Real Estate: Primary Home $450k (Mortgage: $250k, Principal: $900/mo).
- Income: Primary Salary $175,000 (3% growth, 6% contrib, 4% match).
- Budget Expenses: 
    - Mortgage $2k, Cars $1k, Groceries $1k, Utilities $400, Discretionary $2k.
- Benefits: Household size 5, Shelter costs $2k.
================================================================================