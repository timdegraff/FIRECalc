<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FIRECalc</title>
    
    <!-- Desktop/Mobile Redirect Logic -->
    <script>
        if (window.innerWidth <= 768 && !window.location.href.includes('mobile.html')) {
            window.location.href = 'mobile.html';
        }
    </script>

    <!-- Tailwind & Chart.js -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- SortableJS for Drag and Drop -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    
    <!-- Favicon (Data URI to prevent 404) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ“ˆ</text></svg>">
    
    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="index.css">
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://esm.sh/@google/genai@^1.35.0",
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
</head>
<body class="bg-[#0B0F19] text-slate-300 font-inter h-screen overflow-hidden selection:bg-blue-500/30">

    <!-- LOGIN SCREEN -->
    <div id="login-screen" class="fixed inset-0 flex items-center justify-center bg-[#0B0F19] z-50">
        <!-- Content injected by main.js -->
    </div>

    <!-- APP CONTAINER -->
    <div id="app-container" class="hidden flex h-screen w-full">
        
        <!-- SIDEBAR -->
        <aside class="w-80 flex-shrink-0 bg-[#0B0F19] border-r border-slate-800 flex flex-col h-full overflow-hidden z-20">
            <!-- Header/User -->
            <div class="p-6 border-b border-slate-800">
                <div class="flex items-center gap-3 mb-6">
                    <div class="w-10 h-10 rounded-xl bg-blue-600 flex items-center justify-center shadow-lg shadow-blue-900/20">
                        <i class="fas fa-fire text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-black text-white tracking-tighter leading-none">FIRECalc</h1>
                        <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mt-0.5">Architect 3.0</p>
                    </div>
                </div>
                
                <div class="flex items-center gap-3 bg-slate-900/50 p-2 rounded-xl border border-slate-800">
                    <img id="user-avatar" class="w-8 h-8 rounded-lg object-cover bg-slate-800" src="" alt="">
                    <div class="flex-grow overflow-hidden">
                        <div id="user-name" class="text-xs font-bold text-white truncate">Guest</div>
                        <button id="logout-btn" class="text-[9px] font-bold text-slate-500 hover:text-red-400 uppercase tracking-wider transition-colors">Logout</button>
                    </div>
                    <div id="save-indicator" class="text-slate-700 transition-colors duration-500"><i class="fas fa-cloud"></i></div>
                </div>
            </div>

            <!-- Net Worth Summary -->
            <div class="px-6 py-4">
                <p class="label-std mb-1 text-slate-500">Current Net Worth</p>
                <div id="sidebar-networth" class="text-3xl font-black text-teal-400 mono-numbers tracking-tight">$0</div>
                <div id="sidebar-asset-legend" class="mt-3 space-y-1"></div>
            </div>

            <!-- Assumptions Controls (Injected) -->
            <div id="assumptions-container" class="flex-grow overflow-y-auto px-6 py-4 space-y-6 custom-scrollbar">
                <!-- Content injected by core.js -->
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="flex-grow flex flex-col h-full overflow-hidden relative bg-[url('https://grainy-gradients.vercel.app/noise.svg')] bg-opacity-5">
            
            <!-- Top Navigation -->
            <nav class="h-16 flex-shrink-0 border-b border-slate-800 flex items-center justify-between px-8 bg-[#0B0F19]/80 backdrop-blur-md z-30">
                <div id="main-nav" class="flex gap-2">
                    <button class="tab-btn active px-4 py-1.5 text-sm" data-tab="assets-debts">Assets</button>
                    <button class="tab-btn px-4 py-1.5 text-sm" data-tab="income">Income</button>
                    <button class="tab-btn px-4 py-1.5 text-sm" data-tab="budget">Budget</button>
                    <button class="tab-btn px-4 py-1.5 text-sm" data-tab="burndown">Burndown</button>
                    <button class="tab-btn px-4 py-1.5 text-sm" data-tab="benefits">Benefits</button>
                    <button class="tab-btn px-4 py-1.5 text-sm" data-tab="projection">Projection</button>
                </div>
                <div class="flex items-center gap-6">
                    <div class="text-right hidden xl:block">
                        <p class="label-std text-slate-600">FI Number</p>
                        <p class="text-sm font-bold text-slate-400 mono-numbers"><span id="sum-budget-total" class="text-white">$0</span> / yr</p>
                    </div>
                </div>
            </nav>

            <!-- Scrollable Viewport -->
            <div class="flex-grow overflow-y-auto p-8 custom-scrollbar">
                
                <!-- TAB: ASSETS & DEBTS -->
                <section id="tab-assets-debts" class="tab-content max-w-7xl mx-auto space-y-8">
                    <!-- Top Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div class="card-container p-4">
                            <p class="label-std text-slate-500">Total Assets</p>
                            <p id="sum-assets" class="text-2xl font-black text-emerald-400 mono-numbers">$0</p>
                        </div>
                        <div class="card-container p-4">
                            <p class="label-std text-slate-500">Total Liabilities</p>
                            <p id="sum-liabilities" class="text-2xl font-black text-red-400 mono-numbers">$0</p>
                        </div>
                        <div class="card-container p-4">
                            <p class="label-std text-slate-500">Net Worth</p>
                            <p id="sum-networth" class="text-2xl font-black text-teal-400 mono-numbers">$0</p>
                        </div>
                        <div class="card-container p-4 border-blue-500/20 bg-blue-500/5">
                            <p class="label-std text-blue-400">Yrs to Retire</p>
                            <p id="sum-yrs-to-retire" class="text-2xl font-black text-blue-400 mono-numbers">0</p>
                        </div>
                    </div>

                    <!-- Investments Table -->
                    <div class="card-container overflow-hidden">
                        <div class="px-6 py-4 border-b border-white/5 flex justify-between items-center bg-slate-800/50">
                            <h3 class="font-bold text-white flex items-center gap-2"><i class="fas fa-chart-line text-emerald-400"></i> Investments</h3>
                            <button data-add-row="investment-rows" data-row-type="investment" class="px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-xs font-bold transition-all shadow-lg shadow-blue-900/20">
                                <i class="fas fa-plus mr-1"></i> Add Account
                            </button>
                        </div>
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr>
                                    <th class="w-8"></th>
                                    <th class="w-1/4" data-sort="name" data-target="investment-rows">Account Name <i class="fas fa-sort ml-1 opacity-30"></i></th>
                                    <th class="w-1/6" data-sort="type" data-target="investment-rows">Type <i class="fas fa-sort ml-1 opacity-30"></i></th>
                                    <th class="w-1/6 text-right" data-sort="value" data-target="investment-rows">Value <i class="fas fa-sort ml-1 opacity-30"></i></th>
                                    <th class="w-1/6 text-right" data-sort="costBasis" data-target="investment-rows">Cost Basis <i class="fas fa-sort ml-1 opacity-30"></i></th>
                                    <th class="w-12"></th>
                                </tr>
                            </thead>
                            <tbody id="investment-rows" class="bg-black/20"></tbody>
                        </table>
                    </div>

                    <!-- Stock Options & Real Estate Grid -->
                    <div class="grid grid-cols-1 xl:grid-cols-2 gap-8">
                        <!-- Stock Options -->
                        <div class="card-container overflow-hidden">
                            <div class="px-6 py-4 border-b border-white/5 flex justify-between items-center bg-slate-800/50">
                                <h3 class="font-bold text-white flex items-center gap-2"><i class="fas fa-layer-group text-blue-400"></i> Stock Options</h3>
                                <button data-add-row="stock-option-rows" data-row-type="stockOption" class="px-3 py-1 bg-slate-700 hover:bg-slate-600 text-white rounded-lg text-xs font-bold transition-all">Add Grant</button>
                            </div>
                            <table class="w-full text-left border-collapse">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th class="text-right">Shares</th>
                                        <th class="text-right">Strike</th>
                                        <th class="text-right">FMV</th>
                                        <th class="text-center">Growth %</th>
                                        <th class="text-center">Tax</th>
                                        <th class="text-right">Equity</th>
                                        <th class="w-8"></th>
                                    </tr>
                                </thead>
                                <tbody id="stock-option-rows" class="bg-black/20"></tbody>
                            </table>
                        </div>

                        <!-- Real Estate -->
                        <div class="card-container overflow-hidden">
                            <div class="px-6 py-4 border-b border-white/5 flex justify-between items-center bg-slate-800/50">
                                <h3 class="font-bold text-white flex items-center gap-2"><i class="fas fa-home text-indigo-400"></i> Real Estate</h3>
                                <button data-add-row="real-estate-rows" data-row-type="realEstate" class="px-3 py-1 bg-slate-700 hover:bg-slate-600 text-white rounded-lg text-xs font-bold transition-all">Add Property</button>
                            </div>
                            <table class="w-full text-left border-collapse">
                                <thead>
                                    <tr>
                                        <th>Property</th>
                                        <th class="text-right">Value</th>
                                        <th class="text-right">Mortgage</th>
                                        <th class="text-right">Principal</th>
                                        <th class="w-8"></th>
                                    </tr>
                                </thead>
                                <tbody id="real-estate-rows" class="bg-black/20"></tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Liabilities Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div class="card-container overflow-hidden">
                            <div class="px-4 py-3 border-b border-white/5 flex justify-between items-center bg-slate-800/50">
                                <h3 class="font-bold text-white text-sm">Other Assets</h3>
                                <button data-add-row="other-assets-rows" data-row-type="otherAsset" class="w-6 h-6 bg-slate-700 rounded flex items-center justify-center hover:text-white"><i class="fas fa-plus text-xs"></i></button>
                            </div>
                            <table class="w-full text-left">
                                <tbody id="other-assets-rows" class="bg-black/20"></tbody>
                            </table>
                        </div>
                        <div class="card-container overflow-hidden">
                            <div class="px-4 py-3 border-b border-white/5 flex justify-between items-center bg-slate-800/50">
                                <h3 class="font-bold text-white text-sm">HELOCs</h3>
                                <button data-add-row="heloc-rows" data-row-type="heloc" class="w-6 h-6 bg-slate-700 rounded flex items-center justify-center hover:text-white"><i class="fas fa-plus text-xs"></i></button>
                            </div>
                            <table class="w-full text-left">
                                <tbody id="heloc-rows" class="bg-black/20"></tbody>
                            </table>
                        </div>
                        <div class="card-container overflow-hidden">
                            <div class="px-4 py-3 border-b border-white/5 flex justify-between items-center bg-slate-800/50">
                                <h3 class="font-bold text-white text-sm">Unsecured Debt</h3>
                                <button data-add-row="debt-rows" data-row-type="debt" class="w-6 h-6 bg-slate-700 rounded flex items-center justify-center hover:text-white"><i class="fas fa-plus text-xs"></i></button>
                            </div>
                            <table class="w-full text-left">
                                <tbody id="debt-rows" class="bg-black/20"></tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- TAB: INCOME -->
                <section id="tab-income" class="tab-content hidden max-w-7xl mx-auto space-y-8">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        <div class="card-container p-6 flex flex-col items-center justify-center h-28">
                            <p class="label-std mb-2 text-slate-500">Gross Annual Income</p>
                            <p id="sum-gross-income" class="text-4xl font-black text-white mono-numbers tracking-tight">$0</p>
                        </div>
                        <div class="card-container p-6 flex flex-col items-center justify-center h-28">
                            <p class="label-std mb-2 text-slate-500">Taxable AGI (Approx)</p>
                            <p id="sum-income-adjusted" class="text-4xl font-black text-blue-400 mono-numbers tracking-tight">$0</p>
                        </div>
                    </div>

                    <div class="mb-6 flex justify-between items-center">
                        <h2 class="text-xl font-bold text-white">Income Sources</h2>
                        <button data-add-row="income-cards" data-row-type="income" class="px-4 py-2 bg-teal-600 hover:bg-teal-500 text-white rounded-lg text-sm font-bold shadow-lg transition-all">
                            <i class="fas fa-plus mr-2"></i>Add Income Stream
                        </button>
                    </div>

                    <div id="income-cards" class="grid grid-cols-1 xl:grid-cols-2 gap-6">
                        <!-- Dynamic Income Cards -->
                    </div>
                    
                    <div class="card-container p-6 border-l-4 border-l-blue-500 bg-blue-500/5 mt-8">
                        <div class="flex justify-between items-center">
                            <div>
                                <h4 class="font-bold text-white uppercase tracking-wider text-sm mb-1">Retirement Income Floor</h4>
                                <p class="text-xs text-slate-400">Fixed income at start of Social Security</p>
                            </div>
                            <div class="text-right">
                                <div id="sum-retirement-income-floor" class="text-2xl font-black text-blue-400 mono-numbers">$0</div>
                                <div id="sum-floor-breakdown" class="text-[10px] font-bold text-slate-500 uppercase tracking-wider"></div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- TAB: BUDGET -->
                <section id="tab-budget" class="tab-content hidden max-w-7xl mx-auto space-y-8">
                     <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="card-container p-6 flex flex-col items-center justify-center h-28">
                            <p class="label-std mb-2 text-slate-500">Annual Savings</p>
                            <p id="sum-budget-savings" class="text-4xl font-black text-emerald-400 mono-numbers tracking-tight">$0</p>
                        </div>
                        <div class="card-container p-6 flex flex-col items-center justify-center h-28">
                            <p class="label-std mb-2 text-slate-500">ANNUAL SPEND IN 2026</p>
                            <p id="sum-budget-annual" class="text-4xl font-black text-pink-500 mono-numbers tracking-tight">$0</p>
                        </div>
                        <div class="card-container p-6 flex flex-col items-center justify-center h-28">
                            <p class="label-std mb-2 text-slate-500">ANNUAL SPEND IN RETIREMENT</p>
                            <p id="sum-retire-budget" class="text-4xl font-black text-blue-400 mono-numbers tracking-tight">$0</p>
                        </div>
                    </div>

                    <!-- Savings Table -->
                    <div class="card-container overflow-hidden">
                        <div class="px-6 py-4 border-b border-white/5 flex justify-between items-center bg-slate-800/50">
                            <h3 class="font-bold text-white flex items-center gap-2"><i class="fas fa-piggy-bank text-emerald-400"></i> Contributions</h3>
                            <div class="flex gap-2">
                                <button class="px-3 py-1 bg-slate-800 border border-slate-700 text-slate-400 rounded-lg text-xs font-bold hover:text-white" data-paste="spreadsheet" data-target="budget-savings-rows">Paste Data</button>
                                <button data-add-row="budget-savings-rows" data-row-type="budget-savings" class="px-3 py-1 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg text-xs font-bold transition-all">Add Savings</button>
                            </div>
                        </div>
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr>
                                    <th class="w-8"></th>
                                    <th class="w-1/3">Destination</th>
                                    <th class="text-center">Stop at Retirement?</th>
                                    <th class="text-right">Monthly</th>
                                    <th class="text-right">Annual</th>
                                    <th class="w-8"></th>
                                </tr>
                            </thead>
                            <tbody id="budget-savings-rows" class="bg-black/20"></tbody>
                        </table>
                    </div>

                    <!-- Expenses Table -->
                    <div class="card-container overflow-hidden">
                        <div class="px-6 py-4 border-b border-white/5 flex justify-between items-center bg-slate-800/50">
                            <h3 class="font-bold text-white flex items-center gap-2"><i class="fas fa-receipt text-pink-500"></i> Expenses</h3>
                            <div class="flex gap-2">
                                <button class="px-3 py-1 bg-slate-800 border border-slate-700 text-slate-400 rounded-lg text-xs font-bold hover:text-white" data-paste="spreadsheet" data-target="budget-expenses-rows">Paste Data</button>
                                <button data-add-row="budget-expenses-rows" data-row-type="budget-expense" class="px-3 py-1 bg-pink-600 hover:bg-pink-500 text-white rounded-lg text-xs font-bold transition-all">Add Expense</button>
                            </div>
                        </div>
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr>
                                    <th class="w-8"></th>
                                    <th class="w-1/3">Item Name</th>
                                    <th class="text-center">Settings</th>
                                    <th class="text-right">Monthly</th>
                                    <th class="text-right">Annual</th>
                                    <th class="w-8"></th>
                                </tr>
                            </thead>
                            <tbody id="budget-expenses-rows" class="bg-black/20"></tbody>
                        </table>
                    </div>
                </section>

                <!-- TAB: BURNDOWN -->
                <section id="tab-burndown" class="tab-content hidden max-w-7xl mx-auto">
                    <div id="burndown-view-container">
                        <!-- Injected by burndown.js -->
                    </div>
                </section>

                <!-- TAB: BENEFITS -->
                <section id="tab-benefits" class="tab-content hidden max-w-7xl mx-auto">
                    <div id="benefits-module">
                        <!-- Injected by benefits.js -->
                    </div>
                </section>

                <!-- TAB: PROJECTION -->
                <section id="tab-projection" class="tab-content hidden max-w-7xl mx-auto space-y-6">
                    <div class="card-container p-4">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="font-bold text-white flex items-center gap-2">
                                <i class="fas fa-chart-line text-blue-400"></i> Net Worth Projection
                            </h2>
                            <div class="flex items-center gap-4">
                                <div class="flex items-center gap-2">
                                    <label class="label-std text-slate-500">End Age</label>
                                    <div class="flex items-center gap-2 bg-slate-900 rounded-lg border border-slate-700 px-2 py-1">
                                        <span id="label-projection-end" class="text-white font-bold mono-numbers text-sm">72</span>
                                        <input id="input-projection-end" type="range" min="50" max="100" value="72" class="w-24 h-1 bg-slate-600 rounded-lg appearance-none cursor-pointer accent-blue-500">
                                    </div>
                                </div>
                                <button id="toggle-projection-real" class="px-3 py-1.5 bg-slate-800 border border-slate-700 rounded-lg text-xs font-bold text-slate-400 hover:text-white transition-all flex items-center gap-2">
                                    <i class="fas fa-calendar-alt"></i> Nominal Dollars
                                </button>
                            </div>
                        </div>
                        <div class="h-[400px] w-full relative">
                            <canvas id="projection-chart"></canvas>
                        </div>
                    </div>
                    
                    <div class="card-container overflow-hidden">
                        <div class="px-6 py-3 border-b border-white/5 bg-slate-800/50">
                            <h3 class="font-bold text-white text-sm">Data Points</h3>
                        </div>
                        <div id="projection-table-container"></div>
                    </div>
                </section>

            </div>
        </main>
    </div>

    <!-- MAIN SCRIPT -->
    <script type="module" src="main.js"></script>
</body>
</html>